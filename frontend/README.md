
Introduction
------------
The frontend of I3 is a marketplace built using [Django](https://www.djangoproject.com), a Python Web framework that is widely used for websites with large databases. I3 is also built upon the open source code provided by [Digital Marketplace](https://github.com/codingforentrepreneurs/digital-marketplace), which provided much of the structure and functionality for buying and selling digital products. Digital Marketplace is an implementation of Django.


Overview
--------
The source code for the marketplace, located in [src](https://github.com/ANRGUSC/iotm/tree/master/frontend/src), is grouped into [apps](#Apps) which provide data structures and functionality for a specific component of the marketplace system.

The basic modules of an app are:

 * models.py - defines the main data structures and functionality for a particular app. The fields defined in models are entered in the database as a table. Inherits from Django class [Models](https://docs.djangoproject.com/en/1.11/topics/db/models/).
 * admin.py - where we register the models so that they can be seen and manipulated by the site 	administrator.
 * views.py - provides functionality to create, retrieve, update, delete, list, and select items from the 	database. Functions can take a request for an html file and render that page with the relevant 	content. Extends a Django [built-in class-based View](https://docs.djangoproject.com/en/1.11/ref/class-based-views/).
 * urls.py - contains mappings from a url to a function in views that will render the page. See [digitalmarketplace.urls.py](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/digitalmarket/urls.py) for more info.
 
The [digitalmarket](https://github.com/ANRGUSC/iotm/tree/master/frontend/src/digitalmarket) folder contains [settings.py](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/digitalmarket/settings.py) which is generated by [Django](https://docs.djangoproject.com/en/1.8/topics/settings/), and other files pertaining to the project as a whole. The html files are located in the [templates](https://github.com/ANRGUSC/iotm/tree/master/frontend/src/templates) folder and other files related to adding style and functionality to the webpages are located in [static](https://github.com/ANRGUSC/iotm/tree/master/frontend/src/static). [Manage.py](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/manage.py) points to main().

Getting Started
---------------
### Requirements

 * Python 2.7
 * pip (makes installation of python related applications easier)
   * ``$ sudo apt-get install python-pip python-dev build-essential`` 
 * ~~Django 1.11~~
   * ~~``$ sudo pip install django``~~
 * ~~MySQL 14.14~~
   * ~~``$ sudo apt-get install mysql-server``~~
 * ~~mysqlclient 1.3.10~~
   * ~~``$ sudo pip install mysqlclient``~~
 * ~~PIL~~
   * ~~``$ sudo pip install pillow``~~
 * requirements.txt (Installs all above requirements. Must be in root directory of ``iotm``)
   * ``pip install -r requirements.txt``
 * [docutils](http://docutils.sf.net/) (for generating documents)


### Set up

 1. MySQL server

    * run ``$ sudo mysql_secure_installation``.

    * Create a database called "iotm".
   
 2. Configure database

    * Create a configuration file for the database. Here is an example [myconf.cnf](https://github.com/ANRGUSC/iotm/tree/master/frontend).

    * In [digitalmarket.settings.py](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/digitalmarket/settings.py), set path to your cnf file.

      ```
      DATABASES = {
          'default': {
              'ENGINE': 'django.db.backends.mysql',
              'OPTIONS': {
                  'read_default_file': 'your path to myconf.cnf',
                  'init_command': "SET sql_mode='STRICT_TRANS_TABLES'",
              },
          }
      }

      ```
      
  3. Populate database and create a super user.

     ``$ python manage.py makemigrations``</br>
     ``$ python manage.py migrate``</br>
     ``$ python manage.py createsuperuser``</br>

     set usertype to ``2``.
     
  4. Run the server

     * enter ``$ python manage.py runserver``.
     
     * You can paste the server's http address into your browser to view the site.

Front End Walkthrough
-------------

# Creating and Selling a Product

![Creating an accout](CreateAccount.jpg)

Once you access the login page, sign up and create an account. In the above example, we are going to create a 'seller' account. 

![Creating a product](CreateProduct.jpg)

To create a product, navigate to the Product section in the navigation bar and select the 'Create a Product' button. Specify the necessary details of your product as shown in the above example. 

![Credentials](Credentials.jpg)

Once you create your product, you'll recieve publish credentials for your desired sensor/actuators to publish the data. 


# Buying a Product

![Creating a buyer](CreateBuyer.jpg)

Create a buyer account and login

![Dashboard View](Dashboard.jpg)

After successfully logging in, select a product from the Dashboard page.

![Buy a Product](BuyAProduct.jpg)

Purchase the product by selecting 'Add to Cart'. This will direct you to a payment gateway to complete your purchase. 

![Transactions](Transactions.jpg)
After purchasing your product, it should appear as a transaction under 'Purchases'. You will also recieve confirmation that you are allowed to subscribe to the topics that were purchased. 

Documentation
-------------
Once server is running, you can see Django generated documents by viewing the site as an administrator and selecting ``DOCUMENTATION`` from the menu.

One change that was implemented by I3 was switching from SQLite to MySQL


<h3 id="Apps">Apps</h3>

\* *Indicates features added to Digital Marketplace for I3*

  * [analytics](#analytics)
  * [billing](#billing)
  * [checkout](#checkout)
  * [dashboard](#dashboard)
  * [products](#products)
  * [sellers](#sellers)  *not used in I3, will be removed*
  * [tags](#tags)
  * [accounts](#accounts)\* *replaces functionality of sellers*
  * [cart](#cart)*
  * [flows](#flows)*
  * [notifications](#notifications)*
  
  

  
<h3 id="analytics">analytics</h3>

#### [models](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/analytics/models.py)

 * TagViewManager
 * TagView
 
#### [views](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/analytics/views.py)

<h3 id="billing">billing</h3>

#### [models](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/billing/models.py)

 * Transaction *
 * ItemCount *
 * RestrictedRequest
 
#### [views](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/billing/views.py)

 * TransactionView
 
<h3 id="checkout">checkout</h3>

#### [models](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/checkout/models.py)
 
#### [views](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/checkout/views.py)

 * CheckoutAjaxView
 * RequestsAjaxView

<h3 id="dashboard">dashboard</h3>

#### [models](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/dashboard/models.py)
 
#### [views](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/dashboard/views.py)

 * DashboardView
 * UsersListView *
 
<h3 id="products">products</h3>

#### [models](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/products/models.py)

  * Product
  * Thumbnail
  * MyProducts
  * ProductRating
  * CuratedProducts
   
#### [views](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/products/views.py)

 * ProductListView
 * ProductDetailView
 * ProductCreateView
 * ProductRatingAjaxView 
 * ProductUpdateView
 * ProductDownloadView
 * SellerProductListView
 * VendorListView
 
<h3 id="sellers">sellers</h3>  

*not used in I3, will be removed*

#### [models](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/sellers/models.py)

 * SellerAccount


#### [views](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/sellers/views.py)

 * SellerProductDetailRedirectView
 * SellerTransactionListView
 * SellerDashboard
 
<h3 id="tags">tags</h3>

#### [models](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/tags/models.py)
 * TagQuerySet
 * TagManager
 * Tag
 
#### [views](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/tags/views.py)
 * TagDetailView
 * TagListView

<h3 id="accounts">accounts</h3>

#### [models](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/accounts/models.py)
 * User *
 
#### [views](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/accounts/views.py)

 * LoginView *
 * LogoutView *
 * UserCreateView *
 * SignUpView *

<h3 id="cart">cart</h3>

#### [models](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/cart/models.py)

 * Cart *
 * CartItem *
 
#### [views](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/cart/views.py)

 * CartView *
 * CartAjaxView *
   
<h3 id="flows">flows</h3>

#### [models](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/flows/models.py)

 * Flow *
 
#### [views](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/flows/views.py)

 * FlowsView *

<h3 id="notifications">notifications</h3>

#### [models](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/notifications/models.py)

 * NotificationBox *
 * NotificationItem *
 
#### [views](https://github.com/ANRGUSC/iotm/blob/master/frontend/src/notifications/views.py)

 * NotificationBoxView *
 * NotificationUpdateView *

REST API
-------------
The frontend has a REST API. The documentation for the API can be see at [here](https://github.com/ANRGUSC/iotm/blob/crew_branch/frontend/I3%20API%20Documentation.pdf) or on the frontend itself at `/docs`
